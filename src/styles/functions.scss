@use 'sass:map';
@use 'sass:meta';
@use 'sass:string';
@use 'tokens' as *;
@use 'breakpoint' as *;

@function compose($classname) {
	@return string.slice(#{$classname}, 2);
}

@function t2c($target, $context, $unit: vw) {
	$result: null;

	@if meta.type-of($context) == number {
		$result: calc((#{$target} / #{$context}) * 100);
	}

	@else if map.has-key($breakpoints, $context) {
		$result: calc((#{$target} / #{map.get($breakpoints, $context)}) * 100);
	}

	@else {
		@error 'Unknown context argument <#{$context}>';
	}

	@if $unit == p {
		@return (calc(#{$result} * 1%));
	}

	@else if $unit == vw {
		@return (calc(#{$result} * 1vw));
	}

	@else {
		@error 'Unknown unit <#{$unit}>';
	}
}

@function em($px, $context: $size_font_base) {
	@return calc((#{$px} / #{$context}) * 1em);
}

@function rem($px, $base: $size_font_base) {
	@return calc((#{$px} / #{$base}) * 1rem);
}

@function locks(
	$size_min,
	$size_max,
	$viewport_min: map.get($breakpoints, breakpoint_xs),
	$viewport_max: map.get($breakpoints, breakpoint_xl)
) {
	$size_increase: ($size_max - $size_min);
	$viewport_increase: ($viewport_max - $viewport_min);
	$slope: ($size_increase) / ($viewport_increase);
	$initial_size: ($size_min - $slope * $viewport_min) / $size_font_base;

	@return calc(#{$slope * 100}vw + #{$initial_size}rem);
}

@function aspect-ratio($size, $ratio) {
	@return calc(#{$size} / (#{$ratio}));
}

@function image-path($name, $path: $asset_image_dir) {
	@return $path + $name;
}
